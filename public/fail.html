<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ˜¢ ê²°ì œ ì‹¤íŒ¨ - ì‚°íƒ€ë¥¼ ë§Œë‚œ ìˆœê°„</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    .fail-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      text-align: center;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    }
    .fail-card {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    .fail-icon {
      font-size: 80px;
      margin-bottom: 20px;
    }
    .fail-title {
      font-size: 24px;
      color: #c0392b;
      margin-bottom: 10px;
    }
    .fail-message {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
    }
    .error-box {
      background: #ffeaea;
      border: 1px solid #ffcccc;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 25px;
      text-align: left;
    }
    .error-box h4 {
      margin: 0 0 10px 0;
      color: #c0392b;
      font-size: 14px;
    }
    .error-box p {
      margin: 0;
      font-size: 13px;
      color: #666;
    }
    .error-code {
      font-family: monospace;
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
    }
    .solutions {
      text-align: left;
      margin-bottom: 25px;
    }
    .solutions h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #333;
    }
    .solution-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 12px;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    .solution-icon {
      font-size: 20px;
      margin-right: 12px;
    }
    .solution-text {
      font-size: 14px;
      color: #555;
    }
    .btn-group {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .btn-retry {
      display: inline-block;
      background: #c41e3a;
      color: white;
      padding: 15px 30px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    .btn-retry:hover {
      background: #a01830;
      transform: scale(1.05);
    }
    .btn-home {
      display: inline-block;
      background: #6c757d;
      color: white;
      padding: 15px 30px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s;
    }
    .btn-home:hover {
      background: #5a6268;
    }
    .support-info {
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid #eee;
      font-size: 13px;
      color: #888;
    }
    .support-info a {
      color: #c41e3a;
      text-decoration: none;
    }
    .countdown-notice {
      background: linear-gradient(135deg, #fff3cd, #ffeeba);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .countdown-notice strong {
      color: #856404;
    }
  </style>
</head>
<body>
  <div class="fail-container">
    <div class="fail-card">
      <div class="fail-icon">ğŸ˜¢</div>
      <h1 class="fail-title">ì•—, ê²°ì œê°€ ì‹¤íŒ¨í–ˆì–´ìš”</h1>
      <p class="fail-message">
        ê±±ì • ë§ˆì„¸ìš”! ë‹¤ì‹œ ì‹œë„í•˜ì‹œë©´ ë©ë‹ˆë‹¤.<br>
        ì‚°íƒ€ í• ì•„ë²„ì§€ê°€ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš” ğŸ…
      </p>

      <div class="countdown-notice">
        â° <strong>í¬ë¦¬ìŠ¤ë§ˆìŠ¤ê¹Œì§€ ì–¼ë§ˆ ì•ˆ ë‚¨ì•˜ì–´ìš”!</strong><br>
        ì„œë‘ë¥´ì‹œë©´ ì˜¤ëŠ˜ ë°¤ ì „ì— ë°›ìœ¼ì‹¤ ìˆ˜ ìˆì–´ìš”.
      </div>

      <div class="error-box">
        <h4>âŒ ì˜¤ë¥˜ ì •ë³´</h4>
        <p>
          ì½”ë“œ: <span class="error-code" id="errorCode">UNKNOWN</span><br>
          ì‚¬ìœ : <span id="errorMessage">ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</span>
        </p>
      </div>

      <div class="solutions">
        <h3>ğŸ’¡ ì´ë ‡ê²Œ í•´ë³´ì„¸ìš”</h3>
        <div class="solution-item">
          <span class="solution-icon">ğŸ’³</span>
          <span class="solution-text">ì¹´ë“œ í•œë„ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. ì´ë²ˆ ë‹¬ ì‚¬ìš© ê°€ëŠ¥ ê¸ˆì•¡ì´ ì¶©ë¶„í•œê°€ìš”?</span>
        </div>
        <div class="solution-item">
          <span class="solution-icon">ğŸ”„</span>
          <span class="solution-text">ë‹¤ë¥¸ ê²°ì œ ìˆ˜ë‹¨(ë‹¤ë¥¸ ì¹´ë“œ, ì¹´ì¹´ì˜¤í˜ì´ ë“±)ìœ¼ë¡œ ì‹œë„í•´ë³´ì„¸ìš”.</span>
        </div>
        <div class="solution-item">
          <span class="solution-icon">ğŸ“±</span>
          <span class="solution-text">ì¹´ë“œì‚¬ ì•±ì—ì„œ ì˜¨ë¼ì¸ ê²°ì œê°€ ì°¨ë‹¨ë˜ì–´ ìˆì§€ ì•Šì€ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</span>
        </div>
        <div class="solution-item">
          <span class="solution-icon">ğŸŒ</span>
          <span class="solution-text">ì¸í„°ë„· ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•˜ê³  í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ë³´ì„¸ìš”.</span>
        </div>
      </div>

      <div class="btn-group">
        <button class="btn-retry" onclick="retryPayment()">ğŸ”„ ë‹¤ì‹œ ê²°ì œí•˜ê¸°</button>
        <a href="/" class="btn-home">ğŸ  ì²˜ìŒìœ¼ë¡œ</a>
      </div>

      <div class="support-info">
        ê³„ì† ë¬¸ì œê°€ ë°œìƒí•˜ì‹œë‚˜ìš”?<br>
        ì¹´ì¹´ì˜¤í†¡ <a href="#">@santa-moment</a>ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.<br>
        (ì£¼ë¬¸ë²ˆí˜¸: <span id="orderId">-</span>)
      </div>
    </div>
  </div>

  <script>
    // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì˜¤ë¥˜ ì •ë³´ ì¶”ì¶œ
    const urlParams = new URLSearchParams(window.location.search);
    const errorCode = urlParams.get('code') || 'UNKNOWN';
    const errorMessage = urlParams.get('message') || 'ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
    const orderId = urlParams.get('orderId');

    // ì˜¤ë¥˜ ì •ë³´ í‘œì‹œ
    document.getElementById('errorCode').textContent = errorCode;
    document.getElementById('errorMessage').textContent = decodeURIComponent(errorMessage);
    
    if (orderId) {
      document.getElementById('orderId').textContent = orderId;
    }

    // ë‹¤ì‹œ ê²°ì œí•˜ê¸°
    function retryPayment() {
      // ì´ì „ ì£¼ë¬¸ ì •ë³´ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ë‹¨ê³„ë¡œ ì´ë™
      const savedOrder = localStorage.getItem('lastOrder');
      if (savedOrder) {
        // ê²°ì œ ë‹¨ê³„ë¡œ ë°”ë¡œ ì´ë™
        window.location.href = '/#step3';
      } else {
        // ì²˜ìŒë¶€í„° ì‹œì‘
        window.location.href = '/';
      }
    }

    // ì—ëŸ¬ ì½”ë“œë³„ ì¶”ê°€ ì•ˆë‚´
    const errorGuides = {
      'PAY_PROCESS_CANCELED': 'ê²°ì œì°½ì—ì„œ ì·¨ì†Œí•˜ì…¨ë„¤ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”!',
      'PAY_PROCESS_ABORTED': 'ê²°ì œê°€ ì¤‘ë‹¨ë˜ì—ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
      'REJECT_CARD_COMPANY': 'ì¹´ë“œì‚¬ì—ì„œ ê²°ì œë¥¼ ê±°ì ˆí–ˆì–´ìš”. ì¹´ë“œì‚¬ì— ë¬¸ì˜í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¹´ë“œë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.',
      'INVALID_CARD_NUMBER': 'ì¹´ë“œ ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš”. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.',
      'INVALID_CARD_EXPIRATION': 'ì¹´ë“œ ìœ íš¨ê¸°ê°„ì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì˜ëª» ì…ë ¥ë˜ì—ˆì–´ìš”.',
      'EXCEED_MAX_AMOUNT': '1íšŒ ê²°ì œ í•œë„ë¥¼ ì´ˆê³¼í–ˆì–´ìš”. ì¹´ë“œ í•œë„ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.'
    };

    if (errorGuides[errorCode]) {
      document.getElementById('errorMessage').textContent = errorGuides[errorCode];
    }
  </script>
</body>
</html>
